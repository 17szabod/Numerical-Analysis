%Using A=hilb(5) (ill-conditioned)

A=hilb(5)

A =

   1.000000000000000   0.500000000000000   0.333333333333333   0.250000000000000   0.200000000000000
   0.500000000000000   0.333333333333333   0.250000000000000   0.200000000000000   0.166666666666667
   0.333333333333333   0.250000000000000   0.200000000000000   0.166666666666667   0.142857142857143
   0.250000000000000   0.200000000000000   0.166666666666667   0.142857142857143   0.125000000000000
   0.200000000000000   0.166666666666667   0.142857142857143   0.125000000000000   0.111111111111111

B=A'*A

B =

   1.463611111111111   0.833333333333333   0.595238095238095   0.466269841269841   0.384424603174603
   0.833333333333333   0.491388888888889   0.357142857142857   0.282738095238095   0.234788359788360
   0.595238095238095   0.357142857142857   0.261797052154195   0.208333333333333   0.173611111111111
   0.466269841269841   0.282738095238095   0.208333333333333   0.166310941043084   0.138888888888889
   0.384424603174603   0.234788359788360   0.173611111111111   0.138888888888889   0.116156620055430

[evec,eval]=eig(B)

evec =

  -0.006173863395901   0.047161806838823   0.214213624140688  -0.601871478353973   0.767854735065807
   0.116692746287740  -0.432667334844569  -0.724102131480633   0.275913417432099   0.445791060462709
  -0.506163657486827   0.667350444540128  -0.120453278535737   0.424876622351521   0.321578294480220
   0.767191193386862   0.233024514284862   0.309573969855052   0.443903038699780   0.253438943245175
  -0.376245546158084  -0.557599947317602   0.565193410520586   0.429013353681685   0.209822636563631


eval =

   0.000000000010811                   0                   0                   0                   0
                   0   0.000000093573611                   0                   0                   0
                   0                   0   0.000130130865138                   0                   0
                   0                   0                   0   0.043486520331706                   0
                   0                   0                   0                   0   2.455647868471443


%How do I know which to choose? See my comments from part (a) for an explanation. I was wrong with my assumption on how to minimize (N), but correct in how to maximize it.

norm(A*evec(1:5,1))

ans =

     3.287928772175490e-06

%Note that this is sqrt(eval(1,1)). Why?
%Proof in Tex document

norm(A*evec(1:5,5))

ans =

   1.567050691098231

ans/norm(A*evec(1:5,1))

ans =

     4.766072502420351e+05

cond(A)

ans =

     4.766072502410004e+05

%Very near perfect approximation! Good job matlab!

%Using A=rand(4) (very well-conditioned (probably))

A=rand(4)

A =

   0.404285379372441   0.400943259269868   0.720668209930110   0.403650088891587
   0.691619793521676   0.928289760775303   0.957269787807081   0.164611629199641
   0.294321562321465   0.095254975073215   0.121480340212843   0.887176346495848
   0.729938658114301   0.297928372202840   0.688348376526415   0.057986630354688

B=A'*A

B =

   1.261220233422339   1.049624099658803   1.491628727440562   0.580480301824555
   1.049624099658803   1.120312202353846   1.394220921368263   0.416431895297441
   1.491628727440562   1.394220921368263   1.924309075976863   0.596165013620138
   0.580480301824555   0.416431895297441   0.596165013620138   0.980474701811558

[evec,eval]=eig(B)

evec =

   0.543364784633569   0.656884557046328   0.011553872090078   0.522612569284256
   0.425050576335140  -0.737794101225613   0.209352834740104   0.480794407559133
  -0.720916107928349   0.072695605681572   0.219480068932276   0.653317544219894
  -0.066080887605430  -0.137396840667204  -0.952820233815116   0.262467191283896


eval =

   0.032663432124375                   0                   0                   0
                   0   0.125970870379646                   0                   0
                   0                   0   0.744612444458646                   0
                   0                   0                   0   4.383069466601938

%How did I choose these vectors? I made the assumption from my last experiment that low eigenvalues correspond to vectors v that minimize (N) and large eigenvalues maximize (N)

norm(A*evec(1:4,1))

ans =

   0.180730274509765

norm(A*evec(1:4,4))

ans =

   2.093578149150860

ans/norm(A*evec(1:4,1))

ans =

  11.583992526043247

cond(A)

ans =

  11.583992526043234

%My assumption was correct! Got both in one try! Many conclusions can be drawn:
%These eigenvectors somehow always contain the smallest and largest v, end they end up being at the edges
%Lower eigenvalues correspond to lower values of ||Av||/||v|| and vice versa, and the eigenvalues are somehow strictly increasing, which causes the eigenvectors of significance to be at the ends
diary off
